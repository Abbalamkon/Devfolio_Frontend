<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DevPort â€” Minimal Developer Portfolio Social</title>
  <meta name="description" content="A minimal Twitter-like UI for developers to post portfolios, like, comment and message." />
  <style>
    :root{
      --bg:#0f1724;--card:#0b1320;--muted:#94a3b8;--accent:#1d9bf0;--glass:rgba(255,255,255,0.04);
      --radius:12px; --glass-2: rgba(255,255,255,0.02);
      --maxw:1000px;
      --success: #22c55e;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef8;background:linear-gradient(180deg,var(--bg),#071027);}
    .app{max-width:1200px;margin:28px auto;padding:12px;display:grid;grid-template-columns:260px 1fr 340px;gap:18px;min-height:80vh}

    /* left sidebar */
    .sidebar{background:linear-gradient(180deg,var(--card), #071427);padding:14px;border-radius:16px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .logo{display:flex;align-items:center;gap:8px;font-weight:700}
    .logo .dot{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7c5cff);display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
    .nav{margin-top:18px;display:flex;flex-direction:column;gap:8px}
    .nav button{background:transparent;border:0;padding:10px 12px;text-align:left;color:var(--muted);border-radius:10px;cursor:pointer}
    .nav button.active, .nav button:hover{color:white;background:var(--glass)}
    .profile-quick{display:flex;gap:12px;align-items:center;margin-top:18px}
    .avatar{width:56px;height:56px;border-radius:10px;background:linear-gradient(180deg,#6487ff,#7cf5d9);display:flex;align-items:center;justify-content:center;color:#042; font-weight:700}
    .small{font-size:13px;color:var(--muted)}

    /* center feed */
    .feed{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:12px;border-radius:16px;min-height:500px}
    .feed-header{display:flex;align-items:center;justify-content:space-between;padding:6px 4px;border-bottom:1px solid var(--glass-2)}
    .search{display:flex;gap:8px;align-items:center}
    .compose{padding:12px;border-radius:12px;background:var(--card);margin:12px 0;display:flex;gap:12px}
    .compose textarea{flex:1;background:transparent;border:0;outline:none;color:inherit;font-size:15px;min-height:54px}
    .compose .compose-actions{display:flex;gap:8px;align-items:center}
    .btn{background:var(--accent);border:0;color:white;padding:10px 12px;border-radius:10px;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid var(--glass);color:var(--muted)}

    .post{display:flex;gap:12px;padding:12px;border-radius:12px;background:linear-gradient(180deg,var(--glass),transparent);margin-bottom:12px}
    .post .left{width:56px}
    .post .content{flex:1}
    .post .meta{display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted)}
    .post img.media{width:100%;border-radius:8px;margin-top:10px;max-height:320px;object-fit:cover}
    .actions{display:flex;gap:8px;margin-top:8px}
    .icon-btn{background:transparent;border:0;color:var(--muted);padding:8px;border-radius:8px;cursor:pointer}
    .icon-btn.liked{color:var(--accent);font-weight:700}

    /* right profile preview */
    .panel{background:linear-gradient(180deg,var(--card),#071427);padding:12px;border-radius:16px}
    .skills{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{padding:6px 8px;border-radius:999px;background:rgba(255,255,255,0.03);font-size:13px;color:var(--muted)}

    /* modals */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:flex;align-items:center;justify-content:center}
    .modal{width:680px;max-width:92%;background:linear-gradient(180deg,#061226,#071427);padding:16px;border-radius:14px}
    .form-row{display:flex;gap:8px;margin-bottom:8px}
    .form-row input,.form-row textarea{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}

    /* small screens */
    @media (max-width:980px){.app{grid-template-columns:1fr; padding:12px}.sidebar{display:none}.panel{display:none}}

    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="logo"><div class="dot">DP</div><div>DevPort</div></div>
      <div class="nav">
        <button id="nav-home" class="active">Home</button>
        <button id="nav-explore">Explore</button>
        <button id="nav-profile">My Profile</button>
        <button id="nav-messages">Messages</button>
        <button id="nav-settings">Settings</button>
      </div>

      <div class="profile-quick">
        <div class="avatar" id="left-avatar">A</div>
        <div>
          <div id="left-username">Guest</div>
          <div class="small">Not signed in</div>
        </div>
      </div>

      <div style="margin-top:14px">
        <button id="signin" class="btn" style="width:100%">Sign in</button>
        <button id="signup" class="btn secondary" style="width:100%;margin-top:8px">Sign up</button>
      </div>

      <div style="margin-top:18px;color:var(--muted);font-size:13px">Tip: This frontend is static/demo. GitHub auth is mocked.</div>

    </aside>

    <main class="feed">
      <div class="feed-header">
        <div style="font-weight:700;font-size:18px">Home</div>
        <div class="search"><input id="globalSearch" placeholder="Search devs or projects" style="padding:8px;border-radius:10px;border:0;background:rgba(255,255,255,0.03);color:inherit;outline:none"/></div>
      </div>

      <div class="compose" id="composeBox">
        <div class="left"><div class="avatar" id="composer-avatar">A</div></div>
        <div style="flex:1">
          <textarea id="composeText" placeholder="Share a project â€” title, demo link, GitHub, image..." maxlength="600"></textarea>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
            <div class="compose-actions">
              <input id="mediaInput" placeholder="Image/Video URL (optional)" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted)" />
              <input id="projectTitle" placeholder="Project title (optional)" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted)" />
            </div>
            <div>
              <button id="postBtn" class="btn">Post</button>
            </div>
          </div>
        </div>
      </div>

      <div id="feedList" style="margin-top:6px">
        <!-- Posts injected here -->
      </div>

      <footer>DevPort demo â€¢ Built with HTML/CSS/JS â€¢ (no server)</footer>
    </main>

    <aside class="panel">
      <div class="panel" style="position:sticky;top:28px">
        <div style="display:flex;gap:12px;align-items:center">
          <div class="avatar" id="right-avatar">A</div>
          <div>
            <div id="right-name">Guest</div>
            <div class="small">@guest</div>
          </div>
        </div>

        <div style="margin-top:12px">
          <div class="small">Bio</div>
          <div id="right-bio" style="margin-top:6px;color:var(--muted)">Sign in to personalize your profile</div>
        </div>

        <div style="margin-top:12px"><div class="small">Skills</div>
          <div class="skills" id="right-skills">
            <div class="chip">HTML</div>
            <div class="chip">CSS</div>
            <div class="chip">JavaScript</div>
          </div>
        </div>

        <div style="margin-top:12px" id="right-links">
          <div class="small">Contacts</div>
          <div style="margin-top:6px;color:var(--muted)">No contact yet</div>
        </div>

      </div>
    </aside>
  </div>

  <!-- Modals -->
  <div id="modalRoot"></div>

  <script>
    // Small robust rewrite: avoid large innerHTML template literals to prevent parser issues.

    const DB = {
      users: JSON.parse(localStorage.getItem('dp_users')||'null') || {
        guest: {username:'guest',name:'Guest',bio:'I build things.',avatar:null,skills:['HTML','CSS','JS'],social:{github:'',twitter:''},email:'',id:'guest'}
      },
      current: localStorage.getItem('dp_current') || null,
      posts: JSON.parse(localStorage.getItem('dp_posts')||'null') || [
        {id:1, userId:'guest',title:'Portfolio Landing',text:'A minimal landing page for my portfolio. Demo: https://example.com GitHub: https://github.com/user/repo',media:'https://images.unsplash.com/photo-1526378727618-8d7781b7a7b1?auto=format&fit=crop&w=1200&q=60',likes:3,comments:[],created:Date.now()-1000*60*60*24},
        {id:2, userId:'guest',title:'Chat Widget',text:'Small chat widget built with vanilla JS. Click demo: https://demo.example',media:'',likes:1,comments:[{user:'guest',text:'Nice work!'}],created:Date.now()-1000*60*60*12}
      ]
    };

    function save(){
      localStorage.setItem('dp_posts',JSON.stringify(DB.posts));
      localStorage.setItem('dp_users',JSON.stringify(DB.users));
      localStorage.setItem('dp_current',DB.current||'');
    }

    // helpers
    const $ = (s)=>document.querySelector(s);
    const uid = ()=>'p'+Math.random().toString(36).slice(2,9);
    const formatTime = (ts)=>{ const d = new Date(ts); return d.toLocaleString(); };

    // elements
    const feedList = $('#feedList');
    const leftAvatar = $('#left-avatar');
    const composerAvatar = $('#composer-avatar');
    const rightAvatar = $('#right-avatar');
    const rightName = $('#right-name');
    const rightBio = $('#right-bio');
    const rightSkills = $('#right-skills');
    const rightLinks = $('#right-links');

    function escapeText(s){ return String(s||''); }

    function renderProfilePreview(){
      const cur = DB.current ? DB.users[DB.current] : DB.users.guest;
      leftAvatar.textContent = cur.name ? cur.name[0].toUpperCase() : 'G';
      composerAvatar.textContent = leftAvatar.textContent;
      rightAvatar.textContent = leftAvatar.textContent;
      rightName.textContent = cur.name || cur.username;
      rightBio.textContent = cur.bio || 'Add a short bio to tell people who you are.';
      // skills
      rightSkills.innerHTML = '';
      (cur.skills||[]).slice(0,8).forEach(s=>{
        const el = document.createElement('div'); el.className='chip'; el.textContent = s; rightSkills.appendChild(el);
      });
      // social links
      rightLinks.innerHTML = '';
      const c = document.createElement('div'); c.className='small'; c.textContent='Contacts';
      const cont = document.createElement('div'); cont.style.marginTop='6px'; cont.style.color='var(--muted)';
      cont.textContent = (cur.social && (cur.social.github || cur.social.twitter)) ? ((cur.social.github? 'GitHub: '+cur.social.github : '') + (cur.social.twitter? ' Twitter: '+cur.social.twitter : '')) : 'No contact yet';
      rightLinks.appendChild(c); rightLinks.appendChild(cont);
    }

    function clearChildren(el){ while(el.firstChild) el.removeChild(el.firstChild); }

    function renderPosts(filter=''){
      clearChildren(feedList);
      const posts = DB.posts.slice().sort((a,b)=>b.created - a.created).filter(p=>{
        if(!filter) return true;
        const q = filter.toLowerCase();
        const user = DB.users[p.userId]||{};
        return (p.title||'').toLowerCase().includes(q) || (p.text||'').toLowerCase().includes(q) || (user.username||'').toLowerCase().includes(q);
      });
      posts.forEach(p=>{
        feedList.appendChild(postCard(p));
      });
    }

    function postCard(p){
      const user = DB.users[p.userId] || {name:'Unknown',username:'unknown'};
      const root = document.createElement('div'); root.className='post';

      const left = document.createElement('div'); left.className='left';
      const av = document.createElement('div'); av.className='avatar'; av.textContent = (user.name||user.username||'U')[0].toUpperCase(); left.appendChild(av);

      const content = document.createElement('div'); content.className='content';
      const header = document.createElement('div'); header.style.display='flex'; header.style.justifyContent='space-between'; header.style.alignItems='center';

      const headLeft = document.createElement('div');
      const nameEl = document.createElement('div'); nameEl.style.fontWeight='700'; nameEl.textContent = user.name || user.username;
      const uname = document.createElement('span'); uname.style.color='var(--muted)'; uname.style.fontWeight='500'; uname.textContent = ' @' + user.username;
      nameEl.appendChild(uname);
      const meta = document.createElement('div'); meta.className='meta'; meta.textContent = formatTime(p.created);
      headLeft.appendChild(nameEl); headLeft.appendChild(meta);

      const headRight = document.createElement('div');
      if(DB.current === p.userId){
        const edit = document.createElement('button'); edit.className='icon-btn'; edit.textContent='Edit'; edit.addEventListener('click',()=>openEditPost(p.id));
        const del = document.createElement('button'); del.className='icon-btn'; del.textContent='Delete'; del.addEventListener('click',()=>deletePost(p.id));
        headRight.appendChild(edit); headRight.appendChild(del);
      } else {
        const msg = document.createElement('button'); msg.className='icon-btn'; msg.textContent='Message'; msg.addEventListener('click',()=>openMessage(p.userId)); headRight.appendChild(msg);
      }

      header.appendChild(headLeft); header.appendChild(headRight);

      const title = document.createElement('div'); title.style.marginTop='8px'; title.style.fontWeight='600'; title.textContent = p.title || '';
      const txt = document.createElement('div'); txt.style.marginTop='6px'; txt.style.color='var(--muted)'; txt.textContent = escapeText(p.text || '');

      content.appendChild(header); content.appendChild(title); content.appendChild(txt);

      if(p.media){
        const img = document.createElement('img'); img.className='media'; img.src = p.media; img.alt = 'media'; content.appendChild(img);
      }

      const actions = document.createElement('div'); actions.className='actions';
      const likeBtn = document.createElement('button'); likeBtn.className='icon-btn like-btn'; likeBtn.textContent = `â¤ï¸ ${p.likes||0}`; likeBtn.addEventListener('click',()=>{ toggleLike(p.id, likeBtn); });
      const commentBtn = document.createElement('button'); commentBtn.className='icon-btn comment-btn'; commentBtn.textContent = `ðŸ’¬ ${p.comments? p.comments.length:0}`; commentBtn.addEventListener('click',()=>{ openComments(p.id); });
      const openBtn = document.createElement('button'); openBtn.className='icon-btn'; openBtn.textContent='ðŸ”— Open'; openBtn.addEventListener('click',()=>openProject(p.id));
      actions.appendChild(likeBtn); actions.appendChild(commentBtn); actions.appendChild(openBtn);

      content.appendChild(actions);

      root.appendChild(left); root.appendChild(content);
      return root;
    }

    function toggleLike(id, btn){
      const p = DB.posts.find(x=>x.id==id); if(!p) return;
      p._liked = !p._liked; p.likes = (p.likes||0) + (p._liked?1:-1); if(p.likes<0) p.likes = 0; save(); renderPosts($('#globalSearch').value);
    }

    function createModal(node){
      const backdrop = document.createElement('div'); backdrop.className='modal-backdrop';
      const modal = document.createElement('div'); modal.className='modal';
      modal.appendChild(node);
      backdrop.appendChild(modal);
      document.getElementById('modalRoot').appendChild(backdrop);
      return backdrop;
    }

    function openComments(id){
      const p = DB.posts.find(x=>x.id==id); if(!p) return;
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent = 'Comments â€” ' + (p.title||'post'); container.appendChild(h);
      const list = document.createElement('div'); list.style.maxHeight='300px'; list.style.overflow='auto'; list.style.marginTop='8px';
      (p.comments||[]).forEach(c=>{
        const wrap = document.createElement('div'); wrap.style.padding='8px'; wrap.style.borderRadius='8px'; wrap.style.background='rgba(255,255,255,0.02)'; wrap.style.marginBottom='8px';
        const b = document.createElement('b'); b.textContent = c.user; wrap.appendChild(b);
        const d = document.createElement('div'); d.style.color='var(--muted)'; d.style.marginTop='4px'; d.textContent = c.text; wrap.appendChild(d);
        list.appendChild(wrap);
      });
      container.appendChild(list);

      const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px'; row.style.marginTop='10px';
      const input = document.createElement('input'); input.placeholder='Write a comment'; input.style.flex='1'; input.style.padding='8px'; input.style.borderRadius='8px'; input.style.background='transparent'; input.style.border='1px solid rgba(255,255,255,0.03)';
      const send = document.createElement('button'); send.className='btn'; send.textContent='Send'; send.addEventListener('click',()=>{
        const txt = input.value.trim(); if(!txt) return alert("Comment can't be empty"); p.comments = p.comments||[]; p.comments.push({user:DB.current||'guest', text:txt}); save(); renderPosts($('#globalSearch').value); backdrop.remove();
      });
      row.appendChild(input); row.appendChild(send);
      container.appendChild(row);

      const closeRow = document.createElement('div'); closeRow.style.textAlign='right'; closeRow.style.marginTop='8px';
      const closeBtn = document.createElement('button'); closeBtn.className='btn secondary'; closeBtn.textContent='Close'; closeBtn.addEventListener('click',()=>backdrop.remove()); closeRow.appendChild(closeBtn);
      container.appendChild(closeRow);

      const backdrop = createModal(container);
    }

    function openMessage(userId){
      const user = DB.users[userId] || {name:'Unknown',username:userId};
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent = 'Message ' + (user.name||user.username); container.appendChild(h);
      const ta = document.createElement('textarea'); ta.id='msgText'; ta.placeholder = 'Write a short message'; ta.style.width='100%'; ta.style.height='120px'; ta.style.padding='8px'; ta.style.borderRadius='8px'; ta.style.background='transparent'; ta.style.border='1px solid rgba(255,255,255,0.03)'; container.appendChild(ta);
      const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.marginTop='10px';
      const send = document.createElement('button'); send.className='btn'; send.textContent='Send'; send.addEventListener('click',()=>{ alert('Message sent (mock). In real app this would send via backend)'); backdrop.remove(); });
      const close = document.createElement('button'); close.className='btn secondary'; close.textContent='Close'; close.addEventListener('click',()=>backdrop.remove());
      row.appendChild(send); row.appendChild(close); container.appendChild(row);
      const backdrop = createModal(container);
    }

    function openProject(id){
      const p = DB.posts.find(x=>x.id==id); if(!p) return;
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent = p.title || 'Untitled Project'; container.appendChild(h);
      const desc = document.createElement('div'); desc.style.color='var(--muted)'; desc.style.marginTop='6px'; desc.textContent = p.text || ''; container.appendChild(desc);
      if(p.media){ const wrap = document.createElement('div'); wrap.style.marginTop='10px'; const img = document.createElement('img'); img.src=p.media; img.style.width='100%'; img.style.borderRadius='8px'; img.style.objectFit='cover'; wrap.appendChild(img); container.appendChild(wrap); }
      const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px'; row.style.marginTop='12px';
      const openDemo = document.createElement('a'); openDemo.className='btn'; openDemo.textContent='Open Demo'; openDemo.href='#'; openDemo.addEventListener('click',(e)=>{ e.preventDefault(); alert('Open demo (mock): in a real app this would open the demo link)'); });
      const close = document.createElement('button'); close.className='btn secondary'; close.textContent='Close'; close.addEventListener('click',()=>backdrop.remove());
      row.appendChild(openDemo); row.appendChild(close); container.appendChild(row);
      const backdrop = createModal(container);
    }

    function openEditPost(id){
      const p = DB.posts.find(x=>x.id==id); if(!p) return;
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent = 'Edit Post'; container.appendChild(h);
      const r1 = document.createElement('div'); r1.className='form-row'; const inTitle = document.createElement('input'); inTitle.id='editTitle'; inTitle.value = p.title || ''; r1.appendChild(inTitle); container.appendChild(r1);
      const r2 = document.createElement('div'); r2.className='form-row'; const ta = document.createElement('textarea'); ta.id='editText'; ta.style.height='120px'; ta.value = p.text || ''; r2.appendChild(ta); container.appendChild(r2);
      const r3 = document.createElement('div'); r3.className='form-row'; const inMedia = document.createElement('input'); inMedia.id='editMedia'; inMedia.value = p.media || ''; r3.appendChild(inMedia); container.appendChild(r3);
      const actions = document.createElement('div'); actions.style.display='flex'; actions.style.justifyContent='space-between'; actions.style.marginTop='8px';
      const saveBtn = document.createElement('button'); saveBtn.className='btn'; saveBtn.textContent='Save'; saveBtn.addEventListener('click',()=>{ p.title = inTitle.value.trim(); p.text = ta.value.trim(); p.media = inMedia.value.trim(); save(); renderPosts($('#globalSearch').value); backdrop.remove(); });
      const cancel = document.createElement('button'); cancel.className='btn secondary'; cancel.textContent='Cancel'; cancel.addEventListener('click',()=>backdrop.remove());
      actions.appendChild(saveBtn); actions.appendChild(cancel); container.appendChild(actions);
      const backdrop = createModal(container);
    }

    function deletePost(id){ if(!confirm('Delete this post?')) return; DB.posts = DB.posts.filter(x=>x.id!=id); save(); renderPosts($('#globalSearch').value); }

    // Compose
    $('#postBtn').addEventListener('click',()=>{
      const text = $('#composeText').value.trim(); const media = $('#mediaInput').value.trim(); const title = $('#projectTitle').value.trim();
      if(!text && !media && !title) return alert('Please add text, title or media to post');
      const post = {id: uid(), userId: DB.current || 'guest', title, text, media, likes:0, comments:[], created:Date.now()};
      DB.posts.push(post); save(); renderPosts($('#globalSearch').value);
      $('#composeText').value=''; $('#mediaInput').value=''; $('#projectTitle').value='';
    });

    // Auth (mock)
    $('#signin').addEventListener('click',()=>openSignIn());
    $('#signup').addEventListener('click',()=>openSignUp());

    function openSignIn(){
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent='Sign in'; container.appendChild(h);
      const r1 = document.createElement('div'); r1.className='form-row'; const inpUser = document.createElement('input'); inpUser.id='signinEmail'; inpUser.placeholder='Email or username'; r1.appendChild(inpUser); container.appendChild(r1);
      const r2 = document.createElement('div'); r2.className='form-row'; const inpPass = document.createElement('input'); inpPass.id='signinPass'; inpPass.type='password'; inpPass.placeholder='Password'; r2.appendChild(inpPass); container.appendChild(r2);
      const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px';
      const doSign = document.createElement('button'); doSign.className='btn'; doSign.textContent='Sign in'; doSign.addEventListener('click',()=>{ const u = inpUser.value.trim(); if(!u) return alert('Enter username'); if(!DB.users[u]){ alert('No user found â€” we will create a simple account for demo'); DB.users[u] = {username:u,name:u,bio:'',skills:[],social:{},id:u}; } DB.current = u; save(); renderProfilePreview(); renderPosts($('#globalSearch').value); backdrop.remove(); });
      const doGithub = document.createElement('button'); doGithub.className='btn'; doGithub.textContent='Sign in with GitHub'; doGithub.addEventListener('click',()=>{ alert('Mock GitHub auth â€” in production redirect to GitHub OAuth'); DB.current='guest'; save(); renderProfilePreview(); backdrop.remove(); });
      const closeBtn = document.createElement('button'); closeBtn.className='btn secondary'; closeBtn.textContent='Cancel'; closeBtn.addEventListener('click',()=>backdrop.remove());
      row.appendChild(doSign); row.appendChild(doGithub); row.appendChild(closeBtn); container.appendChild(row);
      const backdrop = createModal(container);
    }

    function openSignUp(){
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent='Sign up'; container.appendChild(h);
      const r1 = document.createElement('div'); r1.className='form-row'; const suName = document.createElement('input'); suName.id='suName'; suName.placeholder='Full name'; r1.appendChild(suName); container.appendChild(r1);
      const r2 = document.createElement('div'); r2.className='form-row'; const suUser = document.createElement('input'); suUser.id='suUser'; suUser.placeholder='Username'; r2.appendChild(suUser); container.appendChild(r2);
      const r3 = document.createElement('div'); r3.className='form-row'; const suEmail = document.createElement('input'); suEmail.id='suEmail'; suEmail.placeholder='Email'; r3.appendChild(suEmail); container.appendChild(r3);
      const r4 = document.createElement('div'); r4.className='form-row'; const suPass = document.createElement('input'); suPass.id='suPass'; suPass.type='password'; suPass.placeholder='Password'; r4.appendChild(suPass); container.appendChild(r4);
      const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px';
      const createBtn = document.createElement('button'); createBtn.className='btn'; createBtn.textContent='Create'; createBtn.addEventListener('click',()=>{ const name = suName.value.trim(); const user = suUser.value.trim(); if(!user) return alert('Pick a username'); if(DB.users[user]) return alert('Username taken (demo)'); DB.users[user] = {username:user,name:name||user,bio:'',skills:['JavaScript'],social:{},id:user}; DB.current = user; save(); renderProfilePreview(); renderPosts($('#globalSearch').value); backdrop.remove(); });
      const cancel = document.createElement('button'); cancel.className='btn secondary'; cancel.textContent='Cancel'; cancel.addEventListener('click',()=>backdrop.remove());
      row.appendChild(createBtn); row.appendChild(cancel); container.appendChild(row);
      const backdrop = createModal(container);
    }

    // Profile editor
    $('#nav-profile').addEventListener('click',()=>openProfileEditor());

    function openProfileEditor(){
      const cur = DB.current ? DB.users[DB.current] : DB.users.guest;
      const container = document.createElement('div');
      const h = document.createElement('h3'); h.textContent='Edit Profile'; container.appendChild(h);
      const r1 = document.createElement('div'); r1.className='form-row'; const pName = document.createElement('input'); pName.id='pName'; pName.value = cur.name || ''; pName.placeholder='Full name'; r1.appendChild(pName); container.appendChild(r1);
      const r2 = document.createElement('div'); r2.className='form-row'; const pBio = document.createElement('input'); pBio.id='pBio'; pBio.value = cur.bio || ''; pBio.placeholder='Short bio'; r2.appendChild(pBio); container.appendChild(r2);
      const r3 = document.createElement('div'); r3.className='form-row'; const pSkills = document.createElement('input'); pSkills.id='pSkills'; pSkills.value = (cur.skills||[]).join(','); pSkills.placeholder='Skills comma separated'; r3.appendChild(pSkills); container.appendChild(r3);
      const r4 = document.createElement('div'); r4.className='form-row'; const pGithub = document.createElement('input'); pGithub.id='pGithub'; pGithub.value = (cur.social && cur.social.github) || ''; pGithub.placeholder='GitHub URL'; r4.appendChild(pGithub); container.appendChild(r4);
      const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px';
      const saveBtn = document.createElement('button'); saveBtn.className='btn'; saveBtn.textContent='Save'; saveBtn.addEventListener('click',()=>{ const name = pName.value.trim(); const bio = pBio.value.trim(); const skills = pSkills.value.split(',').map(s=>s.trim()).filter(Boolean); const github = pGithub.value.trim(); if(!DB.current){ alert('You are currently not signed in. Sign up or sign in to save profile.'); return; } const u = DB.users[DB.current]; u.name = name || u.username; u.bio = bio; u.skills = skills; u.social = u.social || {}; u.social.github = github; save(); renderProfilePreview(); backdrop.remove(); });
      const cancel = document.createElement('button'); cancel.className='btn secondary'; cancel.textContent='Cancel'; cancel.addEventListener('click',()=>backdrop.remove());
      row.appendChild(saveBtn); row.appendChild(cancel); container.appendChild(row);
      const backdrop = createModal(container);
    }

    // search
    $('#globalSearch').addEventListener('input',(e)=>renderPosts(e.target.value));

    // initial render
    renderProfilePreview(); renderPosts();

  </script>
</body>
</html>
